# Windows ç¼–ç é—®é¢˜å®Œæ•´è§£å†³æ–¹æ¡ˆ

## ğŸ” é—®é¢˜è¯Šæ–­

### ç—‡çŠ¶
- Flutter ç¼–è¯‘æ—¶å‡ºç°å¤§é‡ `Expected ';' after this` é”™è¯¯
- é”™è¯¯å‘ç”Ÿåœ¨ä¸­æ–‡å­—ç¬¦ä¸²ä¹‹å
- æ˜¾ç¤ºä¸ºï¼š`'ç”¨æˆ·æœªç™»ï¿½?` è€Œä¸æ˜¯ `'ç”¨æˆ·æœªç™»å½•'`

### æ ¹æœ¬åŸå› 
**Windows ç³»ç»Ÿé»˜è®¤ä»£ç é¡µä¸æ˜¯ UTF-8**ï¼Œå¯¼è‡´ Dart ç¼–è¯‘å™¨ä½¿ç”¨é”™è¯¯çš„å­—ç¬¦ç¼–ç è¯»å–æ–‡ä»¶ã€‚

- âœ“ æºæ–‡ä»¶ç¼–ç æ˜¯æ­£ç¡®çš„ (UTF-8)
- âœ“ æ–‡ä»¶å†…å®¹æ˜¯å®Œæ•´çš„ï¼ˆå·²éªŒè¯ï¼‰
- âœ— Dart ç¼–è¯‘å™¨è¯»å–æ—¶ä½¿ç”¨äº†é”™è¯¯çš„ä»£ç é¡µ

---

## ğŸ› ï¸ è§£å†³æ–¹æ¡ˆï¼ˆæŒ‰æ¨èé¡ºåºï¼‰

### æ–¹æ¡ˆ 1ï¼šä½¿ç”¨è‡ªåŠ¨ä¿®å¤è„šæœ¬ï¼ˆæ¨èï¼‰â­

ç›´æ¥è¿è¡Œæˆ‘ä»¬å‡†å¤‡å¥½çš„æ‰¹å¤„ç†æ–‡ä»¶ï¼š

```batch
fix_encoding_windows.bat
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
1. âœ“ è®¾ç½®æ­£ç¡®çš„ä»£ç é¡µ (UTF-8)
2. âœ“ è®¾ç½®ç¯å¢ƒå˜é‡
3. âœ“ æ¸…ç†æ‰€æœ‰ç¼“å­˜
4. âœ“ éªŒè¯æ–‡ä»¶å®Œæ•´æ€§
5. âœ“ é‡æ–°ç¼–è¯‘

---

### æ–¹æ¡ˆ 2ï¼šæ°¸ä¹…ä¿®æ”¹ç³»ç»Ÿä»£ç é¡µï¼ˆæœ€å½»åº•ï¼‰â­â­â­

#### æ­¥éª¤ Aï¼šä¿®æ”¹æ³¨å†Œè¡¨ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰

1. **æ‰“å¼€ PowerShellï¼ˆç®¡ç†å‘˜æ¨¡å¼ï¼‰**
   - æŒ‰ `Win + X`
   - é€‰æ‹© "Windows PowerShell (ç®¡ç†å‘˜)"

2. **è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š**
   ```powershell
   # è®¾ç½® ANSI ä»£ç é¡µä¸º UTF-8
   Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Nls\CodePage' -Name 'ACP' -Value '65001'

   # è®¾ç½® OEM ä»£ç é¡µä¸º UTF-8
   Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Nls\CodePage' -Name 'OEMCP' -Value '65001'
   ```

3. **é‡å¯ç”µè„‘**

4. **é‡æ–°ç¼–è¯‘ï¼š**
   ```batch
   flutter clean
   flutter pub get
   flutter run
   ```

#### æ­¥éª¤ Bï¼šä½¿ç”¨ Windows è®¾ç½®ï¼ˆWindows 10 1903+ / Windows 11ï¼‰

1. æ‰“å¼€ **è®¾ç½®** > **æ—¶é—´å’Œè¯­è¨€** > **è¯­è¨€å’ŒåŒºåŸŸ**
2. ç‚¹å‡» **ç®¡ç†è¯­è¨€è®¾ç½®**
3. ç‚¹å‡» **æ›´æ”¹ç³»ç»ŸåŒºåŸŸè®¾ç½®**
4. å‹¾é€‰ **âœ“ Beta: ä½¿ç”¨ Unicode UTF-8 æä¾›å…¨çƒè¯­è¨€æ”¯æŒ**
5. **é‡å¯ç”µè„‘**

---

### æ–¹æ¡ˆ 3ï¼šä¸ºæ–‡ä»¶æ·»åŠ  UTF-8 BOM

å¦‚æœæ–¹æ¡ˆ 1 å’Œ 2 éƒ½ä¸è¡Œï¼Œå¯ä»¥å°è¯•æ·»åŠ  BOMï¼š

```bash
python fix_add_bom.py
flutter clean
flutter pub get
flutter run
```

**æ³¨æ„ï¼š**
- Dart å®˜æ–¹ä¸æ¨èä½¿ç”¨ BOM
- å¦‚æœæ·»åŠ  BOM åé—®é¢˜æ›´ä¸¥é‡ï¼Œè¿è¡Œ `python fix_remove_bom.py` ç§»é™¤

---

### æ–¹æ¡ˆ 4ï¼šæ‰‹åŠ¨é€æ­¥ä¿®å¤

å¦‚æœè‡ªåŠ¨è„šæœ¬å¤±è´¥ï¼Œæ‰‹åŠ¨æ‰§è¡Œï¼š

#### æ­¥éª¤ 1: è®¾ç½®ä»£ç é¡µ
```batch
chcp 65001
```

#### æ­¥éª¤ 2: è®¾ç½®ç¯å¢ƒå˜é‡
```batch
set LANG=en_US.UTF-8
set LC_ALL=en_US.UTF-8
```

#### æ­¥éª¤ 3: åœæ­¢æ‰€æœ‰è¿›ç¨‹
```batch
taskkill /F /IM dart.exe
taskkill /F /IM flutter.exe
taskkill /F /IM java.exe
```

#### æ­¥éª¤ 4: å½»åº•æ¸…ç†
```batch
rmdir /s /q build
rmdir /s /q .dart_tool
rmdir /s /q android\build
del .flutter-plugins
del .flutter-plugins-dependencies
flutter clean
```

#### æ­¥éª¤ 5: é‡æ–°ç¼–è¯‘
```batch
flutter pub get
flutter run
```

---

### æ–¹æ¡ˆ 5ï¼šä½¿ç”¨ VS Code é‡æ–°ä¿å­˜æ–‡ä»¶

1. åœ¨ VS Code ä¸­æ‰“å¼€é¡¹ç›®
2. å¯¹äºæ¯ä¸ªæŠ¥é”™çš„æ–‡ä»¶ï¼š
   - æ‰“å¼€æ–‡ä»¶
   - æŒ‰ `Ctrl + Shift + P`
   - è¾“å…¥ "Change File Encoding"
   - é€‰æ‹© "Save with Encoding"
   - é€‰æ‹© "UTF-8"

---

## ğŸ”§ éªŒè¯ä¿®å¤

è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯æ–‡ä»¶ç¼–ç ï¼š

```batch
REM æ£€æŸ¥æ–‡ä»¶å†…å®¹
findstr /C:"ç”¨æˆ·æœªç™»å½•" lib\services\payment_service.dart
findstr /C:"ç”Ÿäº§è€…" lib\models\user_model.dart
findstr /C:"å·²æ”¯ä»˜" lib\models\transaction_model.dart
```

åº”è¯¥çœ‹åˆ°**å®Œæ•´çš„ä¸­æ–‡å­—ç¬¦**ã€‚

---

## ğŸ“Š å¸¸è§é—®é¢˜ FAQ

### Q1: ä¸ºä»€ä¹ˆ git æ˜¾ç¤ºæ–‡ä»¶æ²¡é—®é¢˜ï¼Œä½†ç¼–è¯‘å‡ºé”™ï¼Ÿ
**A:** æºæ–‡ä»¶ç¡®å®æ²¡é—®é¢˜ã€‚é—®é¢˜åœ¨äº Dart ç¼–è¯‘å™¨è¯»å–æ–‡ä»¶æ—¶ä½¿ç”¨çš„å­—ç¬¦ç¼–ç ã€‚

### Q2: ä¸ºä»€ä¹ˆ flutter clean æ²¡ç”¨ï¼Ÿ
**A:** `flutter clean` åªæ¸…ç†æ„å»ºäº§ç‰©ï¼Œä¸è§£å†³ç¼–ç é—®é¢˜ã€‚éœ€è¦ä¿®æ”¹ç³»ç»Ÿä»£ç é¡µã€‚

### Q3: Mac/Linux ä¸Šæœ‰è¿™ä¸ªé—®é¢˜å—ï¼Ÿ
**A:** ä¸€èˆ¬ä¸ä¼šã€‚Mac å’Œ Linux é»˜è®¤ä½¿ç”¨ UTF-8ï¼ŒWindows é»˜è®¤ä½¿ç”¨ GBK/CP936ã€‚

### Q4: èƒ½ä¸èƒ½æŠŠä¸­æ–‡æ”¹æˆè‹±æ–‡ï¼Ÿ
**A:** å¯ä»¥ï¼Œä½†è¿™æ˜¯é€ƒé¿é—®é¢˜ã€‚æ­£ç¡®çš„åšæ³•æ˜¯ä¿®å¤ç¼–ç è®¾ç½®ã€‚

### Q5: æ·»åŠ  BOM å®‰å…¨å—ï¼Ÿ
**A:** å¯¹äº Dart æ–‡ä»¶ï¼Œå®˜æ–¹ä¸æ¨èä½¿ç”¨ BOMã€‚å»ºè®®ä¼˜å…ˆä½¿ç”¨æ–¹æ¡ˆ 1 æˆ– 2ã€‚

---

## ğŸ¯ æ¨èæ‰§è¡Œé¡ºåº

1. **å…ˆè¯•æ–¹æ¡ˆ 1**ï¼ˆè‡ªåŠ¨è„šæœ¬ï¼‰- æœ€å¿«
2. **å¦‚æœä¸è¡Œï¼Œç”¨æ–¹æ¡ˆ 2**ï¼ˆæ°¸ä¹…ä¿®æ”¹ç³»ç»Ÿï¼‰- æœ€å½»åº•
3. **è¿˜ä¸è¡Œï¼Œè¯•æ–¹æ¡ˆ 3**ï¼ˆæ·»åŠ  BOMï¼‰- å¤‡é€‰æ–¹æ¡ˆ
4. **æœ€åç”¨æ–¹æ¡ˆ 5**ï¼ˆVS Code é‡æ–°ä¿å­˜ï¼‰- æ‰‹åŠ¨å…œåº•

---

## ğŸ“ å¦‚æœæ‰€æœ‰æ–¹æ¡ˆéƒ½å¤±è´¥

è¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

```batch
REM ç³»ç»Ÿä¿¡æ¯
systeminfo | findstr /C:"OS Name" /C:"OS Version"

REM ä»£ç é¡µä¿¡æ¯
chcp

REM Flutter ç‰ˆæœ¬
flutter --version

REM æ–‡ä»¶ç¼–ç ä¿¡æ¯
file -b --mime-encoding lib\models\user_model.dart
```

---

**æœ€åæ›´æ–°ï¼š** 2025-11-21
**é€‚ç”¨ç³»ç»Ÿï¼š** Windows 10/11
**Flutter ç‰ˆæœ¬ï¼š** æ‰€æœ‰ç‰ˆæœ¬
